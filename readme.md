# Лабораторные работы по дисциплине "Параллельное программирование"

Выполнил студент гр. 3540201/20201 Сеннов Владимир.

Структура репозитория:
* [report](/report/) — отчет по проделанной работе;
* [solution](/solution/) — исходный код решений, подробнее структура 
описана в [отчете](/report/report.md). 
* [test](/test/) — утилиты для тестирования решения;
* [analysis](/analysis/) — скрипты для обработки результатов 
исследования.


Используемые технологии:
* gcc 11.2.0;
* OpenMPI 4.1.3;
* Python 3.9.

Для отправки необходимых файлов на суперкомпьютер, пропишите необходимые данные
в заголовок файла [send.sh](/send.sh) и запустите его из корневой директории 
проекта.

Скрипт [launcher](/launcher) позволяет запустить различные 
реализации задачи с помощью SLURM. Его можно использовать локально или на 
суперкомпьютере "Политехнический". Скрипт принимает следующие аргументы:

    ./launcher [опции] <действие> <реализация>

Параметр `<действие>` может принимать следующие значения:
* `test` — запустить программу для тестового набора данных, сравнить результаты
с эталоном и вывести результаты сравнения; тест считается пройденным, если 
максимальное отклонение имеет порядок тысячных;
* `run` — запуск в рабочем режиме, на вход программы подаются пользовательские 
данные; если пользователь не указывает файл опцией `-i`, то программа ожидает 
ввод из стандартного потока;
* `speedtest` — запуск эксперимента на одном узле, программа выводит таблицу 
`.csv` с результатами;
* `speedtest2` — запуск эксперимента на двух узлах, программа выводит таблицу 
`.csv` с результатами; действие доступно только для реализаций `cmpi` и `pympi`;
* `speedtest5` — запуск эксперимента на пяти узлах, программа выводит таблицу 
`.csv` с результатами; действие доступно только для реализаций `cmpi` и `pympi`;

Параметр `<реализация>` может принимать следующие значения:
* `pthreads` — реализация POSIX Threads;
* `openmp` — реализация OpenMP;
* `cmpi` — реализация с MPI на С;
* `pympi` — реализация с MPI на Pyhton;
* `all` — выполнение для всех реализаций подряд.

Вывод программы происходит в файлы `launch-<текущее время>` с разрешением 
`.out` для стандартного потока вывода и c разрешением `.err` для потока ошибок.
Пользователь может перенаправить вывод в другие файлы или на консоль с помощью 
опций `-o`, `-e` и `-c`.

Скрипт имеет следующие параметры:
* `-p <partition>`, `--partition <partition>` — выбор раздела на 
суперкомпьютере; доступные варианты: `tornado`, `cascade`, `tornado-k40`; 
значение по умолчанию: `tornado`;
* `-f` — скрипт автоматически выберет другой раздел, если в требуемом не хватает
узлов;
* `-o <file>`, `--stdout <file>` — файл, куда будет направлен стандартный поток 
вывода программы;
* `-e <file>`, `--stderr <file>` — файл, куда будет направлен поток ошибок 
программы;
* `-i <file>`, `--stdin <file>` — файл, откуда будет взят ввод программы, 
используется только для действия `run`;
* `-c`, `--console` — скрипт ожидает завершения задачи, после чего выводит 
результат в консоль, параметры `-o`, `-e` при этом игнорируются;
* `-t`, `--time` — будет измерено время работы утилитой `time`, результат будет
выведен в поток ошибок;
* `-n`, `--number-of-processes` — количество потоков для программы, по 
умолчанию 4.

Ниже приведены примеры использования.

    ./launcher --help
    ./launcher -c test all 
    ./launcher -o res.csv speedtest openmpi 
    ./launcher -i input.txt -p cascade run pthreads
    ./launcher -c -n 14 -t run pympi
